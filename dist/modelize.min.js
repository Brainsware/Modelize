var add_apis_to,api,api_key,api_user;("undefined"==typeof api_user||null===api_user)&&(api_user=""),("undefined"==typeof api_key||null===api_key)&&(api_key=""),api=new $.RestClient("/api/",{stripTrailingSlash:!0,methodOverride:!0,username:api_user,password:api_key}),add_apis_to=function(a,b){var c,d,e;e=[];for(d in a)c=a[d],e.push(api[b][d+"s"]?void 0:api[b].add(d+"s"));return e},ko.observableArray.fn.pushAll=function(a){return itsems instanceof Array?(this.valueWillMutate(),ko.utils.arrayPushAll(this.peek(),a),this.valueHasMutated(),this.peek().length):this.peek().length},ko.bindingHandlers.currency={symbol:ko.observable("â‚¬"),update:function(a,b,c){return ko.bindingHandlers.text.update(a,function(){var a,d;return d=+(ko.utils.unwrapObservable(b())||0),a=ko.utils.unwrapObservable(void 0!==c().symbol?c().symbol:ko.bindingHandlers.currency.symbol),a+" "+d.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")})}},ko.bindingHandlers.date={format:ko.observable("DD.MM.YYYY"),update:function(a,b,c){return ko.bindingHandlers.text.update(a,function(){var a,d;return d=ko.utils.unwrapObservable(b())||"0000-00-00",a=ko.utils.unwrapObservable(void 0!==c().format?c().format:ko.bindingHandlers.date.format),moment(d,"YYYY-M-D").format(a)})}},ko.bindingHandlers.href={update:function(a,b){return ko.bindingHandlers.attr.update(a,function(){return{href:b()}})}},ko.bindingHandlers.src={update:function(a,b){return ko.bindingHandlers.attr.update(a,function(){return{src:b()}})}},ko.bindingHandlers.hidden={update:function(a,b){var c;return c=ko.utils.unwrapObservable(b()),ko.bindingHandlers.visible.update(a,function(){return!c})}},ko.bindingHandlers.allowEdit={update:function(a,b){return b()?void 0:(a.disabled=!0,a.readOnly=!0,$(":input",a).attr("readOnly","readOnly"))}};var DelayedSave,Editable;Editable=function(a,b,c){var d;return d="editing_"+b,Observable(a,b),Observable(a,d,""===a[b]()||null==a[b]()),a[b].subscribe(function(){return function(e){var f;return f=c(e,b),f!==!0?a[d](!1):void 0}}(this)),a["edit_"+b]=function(){return function(){return a[d](!0)}}(this),a},DelayedSave=function(a,b,c){return null==c&&(c=250),clearTimeout(window.timeoutEditor),window.timeoutEditor=setTimeout(function(a){return function(){return"content"===type?a.article().content(window.editor.serialize().post_content.value):"title"===type?a.article().title(window.title_editor.serialize().post_title.value):"pretext"===type?a.article().pretext(window.pretext_editor.serialize().post_pretext.value):void 0}}(this),c)};var __slice=[].slice;$.post_json=function(){var a,b;return b=arguments[0],a=2<=arguments.length?__slice.call(arguments,1):[],0===a.length&&$.post(b,"json"),1===a.length&&$.post(b,a[0],"json"),2===a.length&&$.post(b,a[0],a[1],"json"),4===a.length?console.log(a):void 0},$.get_json=function(){var a,b;return b=arguments[0],a=2<=arguments.length?__slice.call(arguments,1):[],0===a.length&&$.get(b,"json"),1===a.length&&$.get(b,a[0],"json"),2===a.length&&$.get(b,a[0],a[1],"json"),4===a.length?console.log(a):void 0};var Computed,ComputedArray,LazyObservable,LazyObservableArray,Observable,ObservableArray,PureComputed,ko;"undefined"!=typeof require&&null!==require&&(ko=require("../../../knockout/build/output/knockout-latest.debug")),Observable=function(a,b,c){return void 0===c&&(c=a[b]),a[b]=ko.observable(c)},ObservableArray=function(a,b,c){return void 0===c&&(c=[]),a[b]=ko.observableArray(c),a[b].select=function(c){return ko.utils.arrayFilter(a[b].call(),c)},a[b].map=function(c){return ko.utils.arrayMap(a[b].call(),c)}},Computed=function(a,b,c){return a[b]=ko.computed(c,a)},PureComputed=function(a,b,c){return a[b]=ko.pureComputed(c,a)},ComputedArray=function(a,b,c){var d,e;return d="_actual_"+b,e="_"+b,ObservableArray(a,d),a[e]=function(){return function(){return a[d](c()),a[d]()}}(this),a[b]=ko.computed(a[e])},LazyObservable=function(a,b,c,d,e,f){var g;return null==d&&(d=[]),null==e&&(e=null),null==f&&(f=!1),g=f?ko.observableArray(e):ko.observable(e),a[b]=ko.computed({read:function(){return a[b].loaded()===!1&&c.apply(a,d),g()},write:function(c){return a[b].loaded(!0),g(c)},deferEvaluation:!0}),f===!0&&(a[b].remove=function(a){return g.remove(a)},a[b].push=function(a){return g.push(a)}),a[b].loaded=ko.observable(!1),a[b].refresh=function(){return result.loaded(!1)}},LazyObservableArray=function(a,b,c,d,e){return null==d&&(d=[]),null==e&&(e=null),LazyObservable(a,b,c,d,e,!0)},"undefined"!=typeof module&&null!==module&&(module.exports={Observable:Observable,ObservableArray:ObservableArray,Computed:Computed,ComputedArray:ComputedArray,LazyObservable:LazyObservable});var Computed,Ham,Observable,Observables,Paginated;"undefined"!=typeof require&&null!==require&&(Ham=require("../ham"),Observables=require("../lib/observable"),Observable=Observables.Observable,Computed=Observables.Computed),Paginated=function(a,b){if(null==a||null==b)throw new Error("Error: no object or options given");if("object"!=typeof a)throw new Error("Error: first parameter is not an object");if("function"==typeof b&&(b={method:b}),"object"!=typeof b)throw new Error("Invalid type for second parameter ("+typeof b+"), expected function or object");if(b=Ham.merge(b,{per_page:20,page:0}),b.page>0&&b.page--,!("number"==typeof b.per_page&&b.per_page>0))throw new Error("Invalid per_page value given");if(null==b.method)throw new Error("No reload method given");return Paginated.add_paginated_methods(a,b)},Paginated.add_paginated_methods=function(a,b){return Observable(a,"__collection",b.collection),Observable(a,"__reload",b.method),Observable(a,"__page",b.page),Observable(a,"per_page",b.per_page),Computed(a,"page",function(){return function(){return a.__page()+1}}(this)),Computed(a,"count",function(){return function(){return null!=a.__collection()?a.__collection().count:0}}(this)),Computed(a,"pages",function(){return function(){var b;return b=parseInt(parseFloat(a.count())/parseFloat(a.__page())),parseFloat(a.count())%a.__page()>0&&b++,b}}(this)),a.first_page=function(){return function(){return a.__page(0),a.__collection(a.__reload())}}(this),a.last_page=function(){return function(){return a.__page(a.count()-1),a.__collection(a.__reload())}}(this),a.previous_page=function(){return function(){return a.page()>0?(a.__page(a.page()-1),a.__collection(a.__reload())):void 0}}(this),a.next_page=function(){return function(){return a.page()+1<a.pages()?(a.__page(a.page()+1),a.__collection(a.__reload())):void 0}}(this)},"undefined"!=typeof module&&null!==module&&(module.exports=Paginated);var Selectable;Selectable=function(a){return a.selected=ko.observable(!1),a.select=function(){return function(){return a.selected(!a.selected())}}(this),a};var Sortable;Sortable=function(a){return a.move=function(){return function(b,c){return a.update({sort:b},c)}}(this),a};var Sorted;Sorted=function(a,b){return null==b&&(b=function(a,b){var c,d;return c=a.name().toLowerCase(),d=b.name().toLowerCase(),d>c?-1:c>d?1:0}),a.sort(b)},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var Modelize;Modelize=function(a){var b,c;return null==api[a.api]&&api.add(a.api),b=api[a.api],null!=a.has_one&&add_apis_to(a.has_one,a.api),null!=a.has_many&&add_apis_to(a.has_many,a.api),c=function(c){var d,e,f,g,h,i,j,k,l,m,n;if(null==c&&(c={}),c.api=function(){return b},c.relationship_fields=function(a,b){return[a+"_id",a+"s",a,window[b]]},null!=a.sortable&&a.sortable===!0&&Sortable(c),null!=a.has_one){i=a.has_one;for(h in i)e=i[h],Ham.merge(e,{model:h.capitalize()}),d=function(a,b,d,e){var f;return null==c[a]?(console.log("Tried to access empty relation key: "+a),!1):(("undefined"==typeof f||null===f)&&(f=function(a){return function(b){return a[d](e(b))}}(this)),api[b].read(c[a]).done(f))},f=window[e.model],null!=c[h]?Observable(c,h,new f(c[h])):LazyObservable(c,h,d,c.relationship_fields(h,e.model),new f)}if(null!=a.has_many){j=a.has_many;for(h in j)e=j[h],Ham.merge(e,{model:h.capitalize()}),d=function(a,b,d,e){var f;return("undefined"==typeof f||null===f)&&(f=function(a){return function(c){var d,f,g,h;for(f=[],g=0,h=c.length;h>g;g++)d=c[g],f.push(e(d));return a[b](f)}}(this)),c.api()[b].read(c.id).done(f)},LazyObservableArray(c,h+"s",d,c.relationship_fields(h,e.model)),d=function(b,d,e,f){return function(b){return function(e,g,h){return null==g&&(g={}),null==h&&(h=function(a){return b[d].push(f(a))}),null!=a.belongs_to?c.api()[d].create(a.belongs_to,c.id,g).done(h):c.api()[d].create(c.id,g).done(h)}}(this)},c[h+"_add"]=d.apply(c,c.relationship_fields(h,e.model)),d=function(b,d){return function(){return function(b,e,f){return null!=a.belongs_to?c.api()[d].update(a.belongs_to,c.id,b,e).done(f):c.api()[d].update(c.id,b,e).done(f)}}(this)},c[h+"_update"]=d.apply(c,c.relationship_fields(h,e.model)),d=function(a,b){return function(a){return function(c){var d;return("undefined"==typeof d||null===d)&&(d=function(){return a[b].remove(c)}),c.destroy(d)}}(this)},c[h+"_destroy"]=d.apply(c,c.relationship_fields(h,e.model))}if(null!=a.observable){k=a.observable;for(g in k)h=k[g],Observable(c,h)}if(null!=a.editable){l=a.editable;for(g in l)h=l[g],Editable(c,h,function(){return function(a,b,d){return null==d&&(d=250),null==window.timeoutEditor&&(window.timeoutEditor={}),clearTimeout(window.timeoutEditor[b]),window.timeoutEditor[b]=setTimeout(function(){var d;return d={},d[b]=a,c.update(d)},d)}}(this))}if(null!=a.computed){m=a.computed;for(h in m)f=m[h],Computed(c,h,f)}if(null!=a.functions){n=a.functions;for(h in n)f=n[h],c[h]=f}return c.update=function(){return function(a,b){return c.api().update(c.id,a).done(b)}}(this),c.destroy=function(){return function(a){return c.api().destroy(c.id).done(a)}}(this),c},c.get=function(a,d){var e;return e=function(a){var b,e,f,g;for(g=[],e=0,f=a.length;f>e;e++)b=a[e],g.push(d.push(c(b)));return g},"undefined"==typeof d.push&&("function"!=typeof d&&(console.log("Collection.find 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\nGiven:"),console.log(d)),e=d),null!=a&&null!=a.id?b.read(a.id,a).done(e):b.read(a).done(e)},c.getOne=function(a,b){return c.get(a,{id:b})},c.create=function(a,d){var e;return null==a&&(a={}),e=function(a){return d.push(c(a))},"undefined"==typeof d.push&&("function"!=typeof d&&(console.log("Collection.find 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\nGiven:"),console.log(d)),e=d),a.length>0||"object"==typeof a?b.create(a).done(e):b.create().done(e)},c};
//# sourceMappingURL=modelize.min.map