{"version":3,"sources":["modelize/connector.js","modelize/container.js","modelize/datahandlers/crypto.js","modelize/datahandlers/hash.js","modelize/datahandlers/json.js","modelize/helpers.js","modelize/lib/containable.js","modelize/lib/delayedsave.js","modelize/lib/editable.js","modelize/lib/hashedsave.js","modelize/lib/observable.js","modelize/lib/paginated.js","modelize/lib/relatable.js","modelize/lib/selectable.js","modelize/lib/sjcl.js","modelize/lib/sortable.js","modelize/lib/utils.js","modelize/model.js"],"names":["$","RESTConnector","object_merge","bind","fn","me","apply","arguments","require","window","jQuery","base","settings","default_settings","this","init","get","stripTrailingSlash","methodOverride","connector","RestClient","prototype","base_uri","resource","sub_resources","data","name","results","add","push","module","exports","Computed","Container","DelayedSave","Editable","HashedSave","MappedObservable","Observable","ObservableArray","Observables","PureComputed","ko","options","container","self","index","ref","ref1","ref2","ref3","ref4","ref5","_this","editable","editables","selectable","Selectable","observable","__updated","computed","purecomputed","functions","subscriptions","isObservable","Error","subscribe","CryptoHandler","SJCLUtils","save","load","key","salt","decrypted_data","decryptData","JSON","parse","encryptData","toJSON","HashHandler","getHash","JSONHandler","atob","btoa","Helpers","relationship_fields","model","single_get_fn","id_param","api_name","api","callbackOrObservable","callback","get_one","lazy_get_fn","i","len","m","res","length","read","id","done","lazy_single_get_fn","get_fn","params","belongs_to","create_fn","after_create","stringify","before_create","create","destroy_fn","remove","element","destroy","Containable","init_multi_container","init_single_container","container_fn","datahandler","field","first_class","toLowerCase","type","c","item","items","map","e","value","prop","delay","save_delay","editing","timeoutEditor","clearTimeout","setTimeout","edit_value","update","on_save_success","on_save_fail","fail","property","extend","new_value","r","extenders","target","hash_salt","console","log","LazyObservable","LazyObservableArray","initial_value","observableArray","select","utils","arrayFilter","call","arrayMap","pureComputed","write","deferEvaluation","init_value","make_array","_value","loaded","newValue","splice","args","refresh","Paginated","method","per_page","page","add_paginated_methods","collection","__page","__collection","count","result","parseInt","parseFloat","first_page","__reload","last_page","previous_page","next_page","pages","Relatable","indexOf","l","relation_params","has_one","capitalize","debug","has_many","selected","sjcl","generateKey","password","hex","codec","fromBits","generateSalt","iter","misc","cachedPbkdf2","rand","random","randomWords","adata","options_ret","mode","ts","ks","encrypt","decrypt","hash","sha256","Sortable","move","to","sort","move_ui","targetIndex","String","charAt","toUpperCase","slice","a","b","j","len1","Object","keys","Modelize","sortable","hashed_index","onDestroy","has_data","ref6","ref7","ref8","Array","isArray","param"],"mappings":"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","file":"modelize.min.js","sourcesContent":["var $, RESTConnector, object_merge,\n  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nif (typeof require === 'function') {\n  object_merge = require('./lib/utils');\n  $ = require('jquery');\n  window.jQuery = require('jquery');\n  require('../vendor/jquery.rest/dist/1/jquery.rest.min.js');\n}\n\nRESTConnector = (function() {\n  function RESTConnector(base, settings) {\n    var default_settings;\n    if (base == null) {\n      base = '/api/';\n    }\n    if (settings == null) {\n      settings = {};\n    }\n    this.init = bind(this.init, this);\n    this.get = bind(this.get, this);\n    default_settings = {\n      stripTrailingSlash: true,\n      methodOverride: true\n    };\n    settings = object_merge(settings, default_settings);\n    this.connector = new $.RestClient(base, settings);\n  }\n\n  RESTConnector.prototype.get = function(base_uri) {\n    return this.connector[base_uri];\n  };\n\n  RESTConnector.prototype.init = function(resource, sub_resources) {\n    var data, name, results;\n    if (sub_resources == null) {\n      sub_resources = [];\n    }\n    if (this.connector[resource] == null) {\n      this.connector.add(resource);\n    }\n    results = [];\n    for (name in sub_resources) {\n      data = sub_resources[name];\n      if (!this.connector[resource][name + 's']) {\n        results.push(this.connector[resource].add(name + 's'));\n      } else {\n        results.push(void 0);\n      }\n    }\n    return results;\n  };\n\n  return RESTConnector;\n\n})();\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = RESTConnector;\n}\n\n//# sourceMappingURL=connector.js.map\n","var Computed, Container, DelayedSave, Editable, HashedSave, MappedObservable, Observable, ObservableArray, Observables, PureComputed, ko;\n\nif (typeof require === 'function') {\n  ko = require('knockout');\n  Observables = require('./lib/observable');\n  Observable = Observables.Observable;\n  ObservableArray = Observables.ObservableArray;\n  MappedObservable = Observables.MappedObservable;\n  Computed = Observables.Computed;\n  PureComputed = Observables.PureComputed;\n  Editable = require('./lib/editable');\n  DelayedSave = require('./lib/delayedsave');\n  HashedSave = require('./lib/hashedsave');\n}\n\nContainer = function(options) {\n  var container;\n  if (options == null) {\n    options = {};\n  }\n  'use strict';\n  container = function(self) {\n    var fn, index, name, ref, ref1, ref2, ref3, ref4, ref5;\n    if (self == null) {\n      self = {};\n    }\n    Observable(self, '__updated');\n    self[\"export\"] = (function(_this) {\n      return function() {\n        var data, index, name, ref;\n        data = {};\n        if (options.editable != null) {\n          ref = options.editable;\n          for (index in ref) {\n            name = ref[index];\n            data[name] = self[name]();\n          }\n        }\n        return data;\n      };\n    })(this);\n    self.editables = function() {\n      var editables;\n      editables = [];\n      if (options.editable != null) {\n        editables = options.editable;\n      }\n      return editables;\n    };\n    if ((options.selectable != null) && options.selectable === true) {\n      Selectable(self);\n    }\n    if (options.observable != null) {\n      ref = options.observable;\n      for (index in ref) {\n        name = ref[index];\n        Observable(self, name);\n      }\n    }\n    if (options.editable != null) {\n      ref1 = options.editable;\n      for (index in ref1) {\n        name = ref1[index];\n        Editable(self, name, (function(_this) {\n          return function() {\n            return self.__updated(self[\"export\"]());\n          };\n        })(this));\n      }\n    }\n    if (options.computed != null) {\n      ref2 = options.computed;\n      for (name in ref2) {\n        fn = ref2[name];\n        Computed(self, name, fn);\n      }\n    }\n    if (options.purecomputed != null) {\n      ref3 = options.purecomputed;\n      for (name in ref3) {\n        fn = ref3[name];\n        PureComputed(self, name, fn);\n      }\n    }\n    if (options.functions != null) {\n      ref4 = options.functions;\n      for (name in ref4) {\n        fn = ref4[name];\n        self[name] = fn;\n      }\n    }\n    if (options.subscriptions != null) {\n      ref5 = options.subscriptions;\n      for (name in ref5) {\n        fn = ref5[name];\n        if (!ko.isObservable(self[name])) {\n          throw new Error('No observable to subscribe to found: ' + name);\n        }\n        self[name].subscribe(fn);\n      }\n    }\n    return self;\n  };\n  return container;\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Container;\n}\n\n//# sourceMappingURL=container.js.map\n","var CryptoHandler, SJCLUtils, ko,\n  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nif (typeof require === 'function') {\n  ko = require('knockout');\n  SJCLUtils = require('../lib/sjcl');\n}\n\nCryptoHandler = (function() {\n  function CryptoHandler(settings) {\n    this.save = bind(this.save, this);\n    this.load = bind(this.load, this);\n    if (settings.key == null) {\n      throw new Error('Please provide an encryption key to the crypto handler!');\n    }\n    this.key = settings.key;\n    if (settings.salt != null) {\n      this.salt = settings.salt;\n    }\n  }\n\n  CryptoHandler.prototype.load = function(data) {\n    var decrypted_data;\n    decrypted_data = SJCLUtils.decryptData(this.key, data);\n    return JSON.parse(decrypted_data);\n  };\n\n  CryptoHandler.prototype.save = function(data) {\n    return SJCLUtils.encryptData(this.key, ko.toJSON(data));\n  };\n\n  return CryptoHandler;\n\n})();\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = CryptoHandler;\n}\n\n//# sourceMappingURL=crypto.js.map\n","var HashHandler,\n  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nHashHandler = (function() {\n  function HashHandler(settings) {\n    this.save = bind(this.save, this);\n    if (settings.salt == null) {\n      throw new Error('Please provide a salting hash to the hash handler!');\n    }\n    this.salt = settings.salt;\n  }\n\n  HashHandler.prototype.save = function(data) {\n    return SJCLUtils.getHash(data + this.salt);\n  };\n\n  return HashHandler;\n\n})();\n\n//# sourceMappingURL=hash.js.map\n","var JSONHandler;\n\nJSONHandler = (function() {\n  function JSONHandler() {}\n\n  JSONHandler.prototype.load = function(data) {\n    return JSON.parse(atob(data));\n  };\n\n  JSONHandler.prototype.save = function(data) {\n    return btoa(ko.toJSON(data));\n  };\n\n  return JSONHandler;\n\n})();\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = JSONHandler;\n}\n\n//# sourceMappingURL=json.js.map\n","var Helpers;\n\nHelpers = {\n  relationship_fields: function(name, model, connector, options) {\n    if (options == null) {\n      options = {};\n    }\n    return [name + '_id', name + 's', name, window[model], connector, options];\n  },\n  single_get_fn: function(id_param, api_name, name, model, api, options) {\n    if (options == null) {\n      options = {};\n    }\n    return (function(_this) {\n      return function(callbackOrObservable) {\n        var callback;\n        callback = function(data) {\n          return _this[name](model(data));\n        };\n        if ((callbackOrObservable != null) && typeof callbackOrObservable['push'] === 'undefined') {\n          if (typeof callbackOrObservable !== 'function') {\n            throw new Error('model.find 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\\nGiven: ' + callbackOrObservable);\n          }\n          callback = callbackOrObservable;\n        }\n        return model.get_one(_this[id_param](), callback);\n      };\n    })(this);\n  },\n  lazy_get_fn: function(id_param, api_name, name, model, api, options) {\n    var callback;\n    if (typeof callback === \"undefined\" || callback === null) {\n      callback = (function(_this) {\n        return function(data) {\n          var i, len, m, res;\n          res = [];\n          for (i = 0, len = data.length; i < len; i++) {\n            m = data[i];\n            res.push(model(m));\n          }\n          return _this[api_name](res);\n        };\n      })(this);\n      return api[api_name].read(this.id).done(callback);\n    }\n  },\n  lazy_single_get_fn: function(id_param, api_name, name, model, api, options) {\n    var callback;\n    if (typeof this[id_param] !== 'function') {\n      throw new Error('External key not an observable: ' + id_param);\n    }\n    if (this[id_param]() == null) {\n      throw new Error('Tried to access empty relation key: ' + id_param);\n    }\n    if (typeof this[id_param]() === 'function') {\n      throw new Error('Circular referene? Quitting.');\n    }\n    if (typeof callback === \"undefined\" || callback === null) {\n      callback = (function(_this) {\n        return function(data) {};\n      })(this);\n      this[name](model(data));\n    }\n    return model.get_one(this[id_param](), callback);\n  },\n  get_fn: function(id_param, api_name, name, model, api, options) {\n    if (options == null) {\n      options = {};\n    }\n    return (function(_this) {\n      return function(params, callbackOrObservable) {\n        var callback;\n        if (params == null) {\n          params = {};\n        }\n        callback = function(data) {\n          var i, len, m, res;\n          res = [];\n          for (i = 0, len = data.length; i < len; i++) {\n            m = data[i];\n            res.push(model(m));\n          }\n          return _this[api_name](res);\n        };\n        if ((callbackOrObservable != null) && typeof callbackOrObservable['push'] === 'undefined') {\n          if (typeof callbackOrObservable !== 'function') {\n            throw new Error('model.find 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\\nGiven: ' + callbackOrObservable);\n          }\n          callback = callbackOrObservable;\n        }\n        if (api == null) {\n          throw new Error('No Connector found for resource \"' + api_name + '\" found: ', api);\n        }\n        if ((options.belongs_to != null) && options.belongs_to.length > 0) {\n          return api[api_name].read(options.belongs_to, _this.id, params).done(callback);\n        } else {\n          return api[api_name].read(_this.id, params).done(callback);\n        }\n      };\n    })(this);\n  },\n  create_fn: function(id_param, api_name, name, model, api, options) {\n    return (function(_this) {\n      return function(params, callbackOrObservable) {\n        var callback, m;\n        if (params == null) {\n          params = {};\n        }\n        callback = function(data) {\n          var m;\n          m = model(data);\n          if (m.after_create != null) {\n            m.after_create();\n          }\n          return _this[api_name].push(m);\n        };\n        if (callbackOrObservable != null) {\n          callback = function(data) {\n            var m;\n            m = model(JSON.parse(JSON.stringify(data)));\n            if (m.after_create != null) {\n              m.after_create();\n            }\n            return callbackOrObservable(data);\n          };\n        }\n        if (_this.id == null) {\n          throw new Error('Empty ID. Save parent model first!');\n        }\n        m = model(params);\n        if (m.before_create != null) {\n          m.before_create();\n        }\n        params = m[\"export\"](false, true);\n        if (api == null) {\n          throw new Error('No Connector found for resource \"' + api_name + '\" found: ', api);\n        }\n        if (options.belongs_to.length > 0) {\n          return api[api_name].create(options.belongs_to, _this.id, params).done(callback);\n        } else {\n          return api[api_name].create(_this.id, params).done(callback);\n        }\n      };\n    })(this);\n  },\n  destroy_fn: function(id_param, api_name, name, model, api, options) {\n    return (function(_this) {\n      return function(callback) {\n        if (callback == null) {\n          callback = function(data) {\n            return _this[api_name].remove(element);\n          };\n        }\n        if (_this.id == null) {\n          throw new Error('Empty ID. Save parent model first!');\n        }\n        api = connector.get(api_name);\n        if (options.belongs_to != null) {\n          return api[api_name].destroy(options.belongs_to, _this.id, id).done(callback);\n        } else {\n          return api[api_name].destroy(_this.id, id).done(callback);\n        }\n      };\n    })(this);\n  }\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Helpers;\n}\n\n//# sourceMappingURL=helpers.js.map\n","var Containable, MappedObservable, Observable, ObservableArray, Observables, init_multi_container, init_single_container, ko;\n\nif (typeof require === 'function') {\n  ko = require('knockout');\n  Observables = require('./observable');\n  Observable = Observables.Observable;\n  ObservableArray = Observables.ObservableArray;\n  MappedObservable = Observables.MappedObservable;\n}\n\nContainable = function(self, options) {\n  var container_fn, datahandler, field, first_class, name, ref, settings;\n  ref = options.container;\n  for (name in ref) {\n    settings = ref[name];\n    container_fn = window[name];\n    if (settings.container != null) {\n      container_fn = window[settings.container];\n    }\n    if ((settings.container != null) && typeof settings.container === 'function') {\n      container_fn = settings.container;\n    }\n    if (typeof container_fn !== 'function') {\n      throw new Error('No container \"' + name + '\" found.');\n    }\n    field = name.toLowerCase();\n    if (settings.field != null) {\n      field = settings.field;\n    }\n    if (typeof settings.datahandler !== 'object') {\n      throw new Error('Invalid or no datahandler provided for: \"' + name + '\"', typeof settings.datahandler);\n    }\n    if (settings.datahandler != null) {\n      datahandler = settings.datahandler;\n    }\n    first_class = false;\n    if (settings.first_class != null) {\n      first_class = settings.first_class;\n    }\n    if ((settings.type != null) && settings.type === 'multi') {\n      init_multi_container(self, name, datahandler, container_fn, field, options);\n    } else {\n      init_single_container(self, name, datahandler, container_fn, field, first_class, options);\n    }\n  }\n  return self;\n};\n\ninit_single_container = function(self, name, datahandler, container_fn, field, first_class, options) {\n  var data, editable, i, len, ref;\n  data = {};\n  if (self[field] != null) {\n    data = datahandler.load(self[field]);\n  }\n  Observable(self, name, new container_fn(data));\n  if (first_class === true) {\n    ref = self[name]().editables();\n    for (i = 0, len = ref.length; i < len; i++) {\n      editable = ref[i];\n      MappedObservable(self, editable, self[name](), self[editable]);\n    }\n  }\n  self[name]().__updated.subscribe((function(_this) {\n    return function(data) {\n      var callback;\n      callback = DelayedSave.apply(self, [options, self, datahandler]);\n      return callback(data, field);\n    };\n  })(this));\n  return self[name].subscribe((function(_this) {\n    return function() {\n      var callback;\n      callback = DelayedSave.apply(self, [options, self, datahandler]);\n      return callback(self[name](), field);\n    };\n  })(this));\n};\n\ninit_multi_container = (function(_this) {\n  return function(self, name, datahandler, container_fn, field, options) {\n    var c, data, i, item, items, len;\n    data = {};\n    if (self[field] != null) {\n      data = datahandler.load(self[field]);\n    }\n    items = [];\n    if (data != null) {\n      for (i = 0, len = data.length; i < len; i++) {\n        item = data[i];\n        c = new container_fn(item);\n        items.push(c);\n        c.__updated.subscribe(function() {\n          var callback;\n          callback = DelayedSave.apply(self, [options, self, datahandler]);\n          return callback(self[name]().map(function(e) {\n            return e[\"export\"]();\n          }), field);\n        });\n      }\n    }\n    ObservableArray(self, name, items);\n    self[name + '_add'] = function(params, callback) {\n      if (params == null) {\n        params = {};\n      }\n      c = container_fn(params);\n      if (c.after_create != null) {\n        c.after_create();\n      }\n      if (c.before_create != null) {\n        c.before_create();\n      }\n      if (callback != null) {\n        callback(c);\n      }\n      params = c[\"export\"](false, true);\n      self[name].push(c);\n      return c.__updated.subscribe(function() {\n        callback = DelayedSave.apply(self, [options, self, datahandler]);\n        return callback(self[name]().map(function(e) {\n          return e[\"export\"]();\n        }), field);\n      });\n    };\n    return self[name].subscribe(function() {\n      var callback;\n      callback = DelayedSave.apply(self, [options, self, datahandler]);\n      return callback(self[name]().map(function(e) {\n        return e[\"export\"]();\n      }), field);\n    });\n  };\n})(this);\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Containable;\n}\n\n//# sourceMappingURL=containable.js.map\n","var DelayedSave;\n\nDelayedSave = function(options, self, datahandler) {\n  if (datahandler == null) {\n    datahandler = null;\n  }\n  return (function(_this) {\n    return function(value, prop, delay) {\n      if (delay == null) {\n        delay = 500;\n      }\n      if (self.id == null) {\n        return;\n      }\n      if (options.save_delay != null) {\n        delay = options.save_delay;\n      }\n      if (self[prop] && (self[prop].editing != null)) {\n        self[prop].editing('pending');\n      }\n      if (window.timeoutEditor == null) {\n        window.timeoutEditor = {};\n      }\n      if (window.timeoutEditor[options.api + self.id] == null) {\n        window.timeoutEditor[options.api + self.id] = {};\n      }\n      clearTimeout(window.timeoutEditor[options.api + self.id][prop]);\n      return window.timeoutEditor[options.api + self.id][prop] = setTimeout(function() {\n        var edit_value, res;\n        if (self[prop] && (self[prop].editing != null)) {\n          self[prop].editing('success');\n        }\n        edit_value = {};\n        edit_value[prop] = value;\n        if (datahandler != null) {\n          edit_value[prop] = datahandler.save(value);\n        }\n        res = self.update(edit_value);\n        if (self.on_save_success != null) {\n          res.done(self.on_save_success);\n        }\n        if (self.on_save_fail != null) {\n          return res.fail(self.on_save_fail);\n        }\n      }, delay);\n    };\n  })(this);\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = DelayedSave;\n}\n\n//# sourceMappingURL=delayedsave.js.map\n","var Editable, Observable, Observables, ko;\n\nif (typeof require === 'function') {\n  ko = require('knockout');\n  Observables = require('./observable');\n  Observable = Observables.Observable;\n}\n\nEditable = function(self, property, callback) {\n  Observable(self, property);\n  self[property].extend({\n    editable: \"\"\n  });\n  self[property].subscribe((function(_this) {\n    return function(new_value) {\n      var r;\n      return r = callback(new_value, property);\n    };\n  })(this));\n  return self;\n};\n\nko.extenders.editable = function(target, options) {\n  return target.editing = ko.observable('default');\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Editable;\n}\n\n//# sourceMappingURL=editable.js.map\n","var HashedSave;\n\nHashedSave = function(options, self) {\n  return (function(_this) {\n    return function(value, prop) {\n      var edit_value, res;\n      if (self.id != null) {\n        if (self[prop] && (self[prop].editing != null)) {\n          self[prop].editing('pending');\n        }\n        if (self.hash_salt != null) {\n          value += self.hash_salt;\n        } else {\n          console.log('No salt for hash found. Intentional?');\n        }\n        edit_value = {};\n        edit_value[prop] = SJCLUtils.getHash(value);\n        res = self.update(edit_value);\n        if (self.on_save_success != null) {\n          res.done(self.on_save_success);\n        }\n        if (self.on_save_fail != null) {\n          return res.fail(self.on_save_fail);\n        }\n      }\n    };\n  })(this);\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = HashedSave;\n}\n\n//# sourceMappingURL=hashedsave.js.map\n","var Computed, LazyObservable, LazyObservableArray, MappedObservable, Observable, ObservableArray, PureComputed, ko;\n\nif (typeof require === 'function') {\n  ko = require('knockout');\n}\n\nObservable = function(self, property, initial_value) {\n  if (initial_value === void 0) {\n    initial_value = self[property];\n  }\n  return self[property] = ko.observable(initial_value);\n};\n\nObservableArray = function(self, property, initial_value) {\n  if (initial_value === void 0) {\n    initial_value = [];\n  }\n  self[property] = ko.observableArray(initial_value);\n  self[property].select = function(fn) {\n    return ko.utils.arrayFilter(self[property].call(), fn);\n  };\n  return self[property].map = function(fn) {\n    return ko.utils.arrayMap(self[property].call(), fn);\n  };\n};\n\nComputed = function(self, property, fn) {\n  return self[property] = ko.computed(fn, self);\n};\n\nPureComputed = function(self, property, fn) {\n  return self[property] = ko.pureComputed(fn, self);\n};\n\nMappedObservable = function(self, property, container, initial_value) {\n  self[property] = ko.pureComputed({\n    read: function() {\n      return container[property]();\n    },\n    write: function(value) {\n      return container[property](value);\n    },\n    deferEvaluation: true\n  });\n  if (initial_value != null) {\n    return self[property](initial_value);\n  }\n};\n\nLazyObservable = function(self, property, callback, params, init_value, make_array) {\n  var _value;\n  if (params == null) {\n    params = [];\n  }\n  if (init_value == null) {\n    init_value = null;\n  }\n  if (make_array == null) {\n    make_array = false;\n  }\n  if (!make_array) {\n    _value = ko.observable(init_value);\n  } else {\n    _value = ko.observableArray(init_value);\n  }\n  self[property] = ko.computed({\n    read: function() {\n      if (self[property].loaded() === false) {\n        callback.apply(self, params);\n      }\n      return _value();\n    },\n    write: function(newValue) {\n      self[property].loaded(true);\n      return _value(newValue);\n    },\n    deferEvaluation: true\n  });\n  if (make_array === true) {\n    self[property].remove = function(e) {\n      return _value.remove(e);\n    };\n    self[property].push = function(e) {\n      return _value.push(e);\n    };\n    self[property].splice = function(e, i, args) {\n      return _value.splice(e, i, args);\n    };\n  }\n  self[property].loaded = ko.observable(false);\n  return self[property].refresh = function() {\n    return self[property].loaded(false);\n  };\n};\n\nLazyObservableArray = function(self, property, callback, params, init_value) {\n  if (params == null) {\n    params = [];\n  }\n  if (init_value == null) {\n    init_value = null;\n  }\n  return LazyObservable(self, property, callback, params, init_value, true);\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = {\n    Observable: Observable,\n    ObservableArray: ObservableArray,\n    Computed: Computed,\n    PureComputed: PureComputed,\n    LazyObservable: LazyObservable\n  };\n}\n\n//# sourceMappingURL=observable.js.map\n","var Paginated;\n\nPaginated = function(self, options) {\n  if (!((self != null) && (options != null))) {\n    throw new Error('Error: no object or options given');\n  }\n  if ('object' !== typeof self) {\n    throw new Error('Error: first parameter is not an object');\n  }\n  if ('function' === typeof options) {\n    options = {\n      method: options\n    };\n  }\n  if ('object' !== typeof options) {\n    throw new Error('Invalid type for second parameter (' + typeof options + '), expected function or object');\n  }\n  options = object_merge(options, {\n    per_page: 20,\n    page: 0\n  });\n  if (options.page > 0) {\n    options.page--;\n  }\n  if (!(typeof options.per_page === 'number' && options.per_page > 0)) {\n    throw new Error('Invalid per_page value given');\n  }\n  if (options.method == null) {\n    throw new Error('No reload method given');\n  }\n  return Paginated.add_paginated_methods(self, options);\n};\n\nPaginated.add_paginated_methods = function(self, options) {\n  Observable(self, '__collection', options.collection);\n  Observable(self, '__reload', options.method);\n  Observable(self, '__page', options.page);\n  Observable(self, 'per_page', options.per_page);\n  Computed(self, 'page', (function(_this) {\n    return function() {\n      return self.__page() + 1;\n    };\n  })(this));\n  Computed(self, 'count', (function(_this) {\n    return function() {\n      if (self.__collection() != null) {\n        return self.__collection().count;\n      }\n      return 0;\n    };\n  })(this));\n  Computed(self, 'pages', (function(_this) {\n    return function() {\n      var result;\n      result = parseInt(parseFloat(self.count()) / parseFloat(self.__page()));\n      if (parseFloat(self.count()) % self.__page() > 0) {\n        result++;\n      }\n      return result;\n    };\n  })(this));\n  self.first_page = (function(_this) {\n    return function() {\n      self.__page(0);\n      return self.__collection(self.__reload());\n    };\n  })(this);\n  self.last_page = (function(_this) {\n    return function() {\n      self.__page(self.count() - 1);\n      return self.__collection(self.__reload());\n    };\n  })(this);\n  self.previous_page = (function(_this) {\n    return function() {\n      if (!(self.page() > 0)) {\n        return;\n      }\n      self.__page(self.page() - 1);\n      return self.__collection(self.__reload());\n    };\n  })(this);\n  return self.next_page = (function(_this) {\n    return function() {\n      if (!(self.page() + 1 < self.pages())) {\n        return;\n      }\n      self.__page(self.page() + 1);\n      return self.__collection(self.__reload());\n    };\n  })(this);\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Paginated;\n}\n\n//# sourceMappingURL=paginated.js.map\n","var Helpers, Observable, ObservableArray, Observables, Relatable, object_merge,\n  indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nif (typeof require === 'function') {\n  object_merge = require('./utils');\n  Helpers = require('../helpers');\n  Observables = require('./observable');\n  Observable = Observables.Observable;\n  ObservableArray = Observables.ObservableArray;\n}\n\nRelatable = function(self, options) {\n  var data, fn, i, item, items, len, name, ref, ref1, ref2, ref3, relation_params, results;\n  if (options.belongs_to != null) {\n    if (options.has_one == null) {\n      options.has_one = [];\n    }\n    options.has_one = object_merge(options.belongs_to, options.has_one);\n  } else {\n    options.belongs_to = [];\n  }\n  if (options.has_one != null) {\n    ref = options.has_one;\n    for (name in ref) {\n      data = ref[name];\n      object_merge(data, {\n        model: name.capitalize()\n      });\n      relation_params = Helpers.relationship_fields(name, data.model, self.api(), options);\n      fn = window[data.model];\n      if ((data.model != null) && typeof data.model === 'function') {\n        fn = data.model;\n      }\n      if (typeof fn !== 'function') {\n        console.debug('Relation model for \"' + name + '\" not a function: ', fn);\n        throw new Error('No model for has_one/belongs_to relation found');\n      }\n      if (typeof self[name + '_id'] !== 'function' && indexOf.call(options.belongs_to, name) < 0) {\n        if (options.editable == null) {\n          options.editable = [];\n        }\n        if (ref1 = name + '_id', indexOf.call(options.editable, ref1) < 0) {\n          options.editable.push(name + '_id');\n        }\n      }\n      if (self[name] != null) {\n        Observable(self, name, new fn(self[name]));\n      } else {\n        Observable(self, name, new fn());\n      }\n      self[name + '_get'] = Helpers.single_get_fn.apply(self, relation_params);\n    }\n  }\n  if (options.has_many != null) {\n    ref2 = options.has_many;\n    results = [];\n    for (name in ref2) {\n      data = ref2[name];\n      object_merge(data, {\n        model: name.capitalize()\n      });\n      relation_params = Helpers.relationship_fields(name, data.model, self.api(), options);\n      if (self[name + 's'] != null) {\n        fn = window[data.model];\n        items = [];\n        ref3 = self[name + 's'];\n        for (i = 0, len = ref3.length; i < len; i++) {\n          item = ref3[i];\n          items.push(new fn(item));\n        }\n        ObservableArray(self, name + 's', items);\n      } else {\n        ObservableArray(self, name + 's', []);\n      }\n      self[name + '_get'] = Helpers.get_fn.apply(self, relation_params);\n      self[name + '_add'] = Helpers.create_fn.apply(self, relation_params);\n      results.push(self[name + '_destroy'] = Helpers.destroy_fn.apply(self, relation_params));\n    }\n    return results;\n  }\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Relatable;\n}\n\n//# sourceMappingURL=relatable.js.map\n","var Selectable, ko;\n\nif (typeof require === 'function') {\n  ko = require('knockout');\n}\n\nSelectable = function(self) {\n  self.selected = ko.observable(false);\n  self.select = (function(_this) {\n    return function(item, element) {\n      return self.selected(!self.selected());\n    };\n  })(this);\n  return self;\n};\n\n//# sourceMappingURL=selectable.js.map\n","var SJCLUtils, sjcl;\n\nif (typeof require === 'function') {\n  sjcl = require('sjcl');\n}\n\nSJCLUtils = {\n  generateKey: function(password, salt) {\n    var hex, options;\n    if (password === '') {\n      throw new Error('Password for key generation empty!');\n    }\n    hex = sjcl.codec.hex.fromBits;\n    if (salt == null) {\n      salt = SJCLUtils.generateSalt();\n    }\n    options = {\n      salt: salt,\n      iter: 5000\n    };\n    options = sjcl.misc.cachedPbkdf2(password, options);\n    return sjcl.codec.hex.fromBits(options.key);\n  },\n  generateSalt: function(length) {\n    var rand;\n    if (length == null) {\n      length = 2;\n    }\n    rand = sjcl.random.randomWords(length);\n    return sjcl.codec.hex.fromBits(rand);\n  },\n  encryptData: function(key, data, adata) {\n    var options, options_ret;\n    if (adata == null) {\n      adata = '';\n    }\n    if (key === '') {\n      throw new Error('Encryption key empty!');\n    }\n    options = {\n      mode: 'gcm',\n      iter: 5000,\n      ts: 64,\n      ks: 256,\n      adata: adata\n    };\n    options_ret = {};\n    return sjcl.encrypt(key, data, options, options_ret);\n  },\n  decryptData: function(key, data) {\n    var options_ret;\n    if (key === '') {\n      throw new Error('Decryption key empty!');\n    }\n    options_ret = {};\n    return sjcl.decrypt(key, data, {}, options_ret);\n  },\n  getHash: function(value) {\n    var hash;\n    if (value == null) {\n      console.debug('Hash value empty');\n      value = '';\n    }\n    hash = sjcl.hash.sha256.hash(value);\n    return sjcl.codec.hex.fromBits(hash);\n  }\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = SJCLUtils;\n}\n\n//# sourceMappingURL=sjcl.js.map\n","var Sortable;\n\nSortable = function(self) {\n  self.move = (function(_this) {\n    return function(to, callback) {\n      return self.update({\n        sort: to\n      }, callback);\n    };\n  })(this);\n  self.move_ui = (function(_this) {\n    return function(element) {\n      var item, to;\n      item = element.item;\n      to = element.targetIndex;\n      return item.update({\n        sort: to\n      });\n    };\n  })(this);\n  return self;\n};\n\n//# sourceMappingURL=sortable.js.map\n","var object_merge;\n\nString.prototype.capitalize = function() {\n  return this.charAt(0).toUpperCase() + this.slice(1);\n};\n\nobject_merge = function(a, b) {\n  var i, j, key, len, len1, ref, ref1, result;\n  result = {};\n  ref = Object.keys(a);\n  for (i = 0, len = ref.length; i < len; i++) {\n    key = ref[i];\n    result[key] = a[key];\n  }\n  ref1 = Object.keys(b);\n  for (j = 0, len1 = ref1.length; j < len1; j++) {\n    key = ref1[j];\n    if (a[key] == null) {\n      result[key] = b[key];\n    }\n  }\n  return result;\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = object_merge;\n}\n\n//# sourceMappingURL=utils.js.map\n","var Computed, Containable, DelayedSave, Editable, HashedSave, Modelize, Observable, Observables, PureComputed, Relatable, SJCLUtils, ko, object_merge,\n  indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nif (typeof require === 'function') {\n  ko = require('knockout');\n  object_merge = require('./lib/utils');\n  Observables = require('./lib/observable');\n  Observable = Observables.Observable;\n  Computed = Observables.Computed;\n  PureComputed = Observables.PureComputed;\n  Relatable = require('./lib/relatable');\n  Containable = require('./lib/containable');\n  Editable = require('./lib/editable');\n  DelayedSave = require('./lib/delayedsave');\n  HashedSave = require('./lib/hashedsave');\n  SJCLUtils = require('./lib/sjcl');\n}\n\nModelize = function(options) {\n  'use strict';\n  var connector, model, sub_resources;\n  if (options.connector == null) {\n    throw new Error('No connector given for API URI: ' + options.api);\n  }\n  sub_resources = [];\n  if (options.has_one != null) {\n    sub_resources = object_merge(sub_resources, options.has_one);\n  }\n  if (options.has_many != null) {\n    sub_resources = object_merge(sub_resources, options.has_many);\n  }\n  options.connector.init(options.api, sub_resources);\n  connector = options.connector.get(options.api);\n  model = function(self) {\n    var fn, index, name, ref, ref1, ref2, ref3, ref4, ref5;\n    if (self == null) {\n      self = {};\n    }\n    self.api = function() {\n      return connector;\n    };\n    if (options.hash_salt != null) {\n      self.hash_salt = options.hash_salt;\n    }\n    if ((options.sortable != null) && options.sortable === true) {\n      Sortable(self);\n    }\n    if ((options.selectable != null) && options.selectable === true) {\n      Selectable(self);\n    }\n    if ((options.has_one != null) || (options.has_many != null) || (options.belongs_to != null)) {\n      Relatable(self, options);\n    }\n    if (options.container != null) {\n      Containable(self, options);\n    }\n    if (options.observable != null) {\n      ref = options.observable;\n      for (index in ref) {\n        name = ref[index];\n        Observable(self, name);\n      }\n    }\n    if (options.editable != null) {\n      ref1 = options.editable;\n      for (index in ref1) {\n        name = ref1[index];\n        Editable(self, name, DelayedSave.apply(self, [options, self]));\n      }\n    }\n    if (options.hashed_index != null) {\n      ref2 = options.hashed_index;\n      for (index in ref2) {\n        name = ref2[index];\n        Editable(self, name, HashedSave.apply(self, [options, self]));\n      }\n    }\n    if (options.computed != null) {\n      ref3 = options.computed;\n      for (name in ref3) {\n        fn = ref3[name];\n        Computed(self, name, fn);\n      }\n    }\n    if (options.purecomputed != null) {\n      ref4 = options.purecomputed;\n      for (name in ref4) {\n        fn = ref4[name];\n        PureComputed(self, name, fn);\n      }\n    }\n    if (options.functions != null) {\n      ref5 = options.functions;\n      for (name in ref5) {\n        fn = ref5[name];\n        self[name] = fn;\n      }\n    }\n    self.update = (function(_this) {\n      return function(params, callback) {\n        if (self.id == null) {\n          throw new Error('Trying to update nonexisting model object');\n        }\n        return self.api().update(self.id, params).done(callback);\n      };\n    })(this);\n    self.destroy = (function(_this) {\n      return function(callback) {\n        if (self.id == null) {\n          throw new Error('Trying to delete nonexisting model object');\n        }\n        if (self.onDestroy != null) {\n          self.onDestroy();\n        }\n        return self.api().destroy(self.id).done(callback);\n      };\n    })(this);\n    self.create = (function(_this) {\n      return function(callback) {\n        return self.api().create(self[\"export\"](false, true)).done(function(data) {\n          self.id = data.id;\n          if (callback != null) {\n            return callback();\n          }\n        });\n      };\n    })(this);\n    self[\"export\"] = (function(_this) {\n      return function(id, datahandler) {\n        var data, field, has_data, ref6, ref7, ref8, settings;\n        if (id == null) {\n          id = false;\n        }\n        if (datahandler == null) {\n          datahandler = false;\n        }\n        data = {};\n        if (id === true) {\n          data['id'] = self['id'];\n        }\n        if (options.editable != null) {\n          ref6 = options.editable;\n          for (index in ref6) {\n            name = ref6[index];\n            data[name] = self[name]();\n          }\n        }\n        if (options.belongs_to != null) {\n          ref7 = options.belongs_to;\n          for (name in ref7) {\n            has_data = ref7[name];\n            data[name + '_id'] = self[name + '_id']();\n          }\n        }\n        if (options.container != null) {\n          ref8 = options.container;\n          for (name in ref8) {\n            settings = ref8[name];\n            if (!Array.isArray(self[name]())) {\n              data[name] = self[name]()[\"export\"]();\n            } else {\n              data[name] = [];\n              data[name] = self[name]().map(function(e) {\n                return e[\"export\"]();\n              });\n            }\n            if (datahandler) {\n              field = name.toLowerCase();\n              if (settings.field != null) {\n                field = settings.field;\n              }\n              if (settings.datahandler != null) {\n                datahandler = settings.datahandler;\n              }\n              if (settings.datahandler == null) {\n                datahandler = new JSONHandler();\n              }\n              data[field] = datahandler.save(data[name]);\n              if (name !== field) {\n                delete data[name];\n              }\n            }\n          }\n        }\n        return data;\n      };\n    })(this);\n    return self;\n  };\n\n  /*\n   * These are the collection functions and are not bound to a specific object but to the model\n   */\n  model.get = function(params, callbackOrObservable) {\n    var callback, param, salt;\n    if (params == null) {\n      params = {};\n    }\n    callback = function(data) {\n      var i, len, m, results;\n      results = [];\n      for (i = 0, len = data.length; i < len; i++) {\n        m = data[i];\n        results.push(callbackOrObservable.push(model(m)));\n      }\n      return results;\n    };\n    if (typeof callbackOrObservable['push'] === 'undefined') {\n      if (typeof callbackOrObservable !== 'function') {\n        throw new Error('Collection.get 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\\nGiven: ' + callbackOrObservable);\n      }\n      callback = callbackOrObservable;\n    }\n    if (typeof params !== 'object') {\n      throw new Error('Passed params is not an object: ' + typeof params);\n    }\n    if ((options.hashed_index != null) && (params != null)) {\n      salt = '';\n      if (options.hash_salt != null) {\n        salt = options.hash_salt;\n      }\n      for (param in params) {\n        if (indexOf.call(options.hashed_index, param) >= 0) {\n          params[param] = SJCLUtils.getHash(params[param] + salt);\n        }\n      }\n    }\n    if ((params != null) && (params.id != null)) {\n      return connector.read(params.id, params).done(callback);\n    } else {\n      return connector.read(params).done(callback);\n    }\n  };\n  model.get_one = function(id, callbackOrObservable) {\n    var callback;\n    callback = function(data) {\n      return callbackOrObservable(model(data));\n    };\n    if (ko.isObservable(callbackOrObservable) === false) {\n      if (typeof callbackOrObservable !== 'function') {\n        throw new Error('Collection.get_one 2nd parameter needs to be either a function or an Observable.\\nGiven: ' + callbackOrObservable);\n      }\n      callback = callbackOrObservable;\n    }\n    return model.get({\n      id: id\n    }, callback);\n  };\n  model.create = function(params, callbackOrObservable) {\n    var callback, m;\n    if (params == null) {\n      params = {};\n    }\n    callback = function(data) {\n      return callbackOrObservable.push(model(data));\n    };\n    if (typeof callbackOrObservable['push'] === 'undefined') {\n      if (typeof callbackOrObservable !== 'function') {\n        throw new Error('Collection.create 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\\nGiven: ' + callbackOrObservable);\n      }\n      callback = (function(_this) {\n        return function(data) {\n          var m;\n          m = model(JSON.parse(JSON.stringify(data)));\n          if (m.after_create != null) {\n            m.after_create();\n          }\n          return callbackOrObservable(data);\n        };\n      })(this);\n    }\n    m = model(params);\n    if (m.before_create != null) {\n      m.before_create();\n    }\n    params = m[\"export\"](false, true);\n    return connector.create(params).done(callback);\n  };\n  return model;\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Modelize;\n}\n\n//# sourceMappingURL=model.js.map\n"]}