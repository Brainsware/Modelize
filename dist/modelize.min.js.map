{"version":3,"file":"modelize.min.js","sources":["modelize/connector.js","modelize/container.js","modelize/crypto.js","modelize/datahandlers/crypto.js","modelize/datahandlers/hash.js","modelize/datahandlers/json.js","modelize/ham.js","modelize/helpers.js","modelize/lib/containable.js","modelize/lib/editable.js","modelize/lib/encryptable.js","modelize/lib/observable.js","modelize/lib/paginated.js","modelize/lib/relatable.js","modelize/lib/selectable.js","modelize/lib/sortable.js","modelize/lib/utils.js","modelize/model.js"],"names":["RESTConnector","bind","fn","me","apply","arguments","base","settings","default_settings","this","init","get","stripTrailingSlash","methodOverride","object_merge","connector","$","RestClient","prototype","base_uri","resource","sub_resources","data","name","results","add","push","module","exports","Connector","Container","options","container","self","index","ref","ref1","ref2","ref3","ref4","Observable","editables","editable","selectable","Selectable","observable","Editable","_this","__updated","computed","Computed","purecomputed","PureComputed","functions","ref5","decryptData","encryptData","generateKey","generateSalt","getHash","password","salt","hex","Error","sjcl","codec","fromBits","iter","misc","cachedPbkdf2","key","length","rand","random","randomWords","adata","options_ret","mode","ts","ks","encrypt","decrypt","value","hash","console","debug","sha256","CryptoHandler","save","load","decrypted_data","JSON","parse","ko","toJSON","HashHandler","JSONHandler","stringify","Ham","merge","a","b","i","j","len","len1","result","Object","keys","create_fn","destroy_fn","get_fn","lazy_get_fn","lazy_single_get_fn","relationship_fields","single_get_fn","update_fn","model","window","id_param","api_name","api","params","callbackOrObservable","callback","get_one","m","res","read","id","done","belongs_to","encrypted_container","encrypt_container","create","update","after_update","remove","element","destroy","Containable","container_fn","datahandler","field","first_class","init_single_container","MappedObservable","subscribe","DelayedSave","init_multi_container","c","item","items","ObservableArray","toLowerCase","type","EncryptedDelayedSave","HashedSave","property","editing_property","new_value","r","prop","delay","timeoutEditor","clearTimeout","setTimeout","edit_value","encryption_salt","log","encrypted_editable","save_encrypted_container","encrypted_debug","Encryptable","indexOf","l","dencdata","encryption_key","encrypted_update","call","encdata","LazyObservable","LazyObservableArray","initial_value","observableArray","select","utils","arrayFilter","map","arrayMap","pureComputed","write","init_value","make_array","_value","loaded","newValue","deferEvaluation","e","splice","args","refresh","ComputedArray","Observables","Paginated","require","method","per_page","page","add_paginated_methods","collection","__page","__collection","count","parseInt","parseFloat","first_page","__reload","last_page","previous_page","next_page","pages","Relatable","relation_params","has_one","capitalize","has_many","selected","Sortable","move","to","sort","move_ui","targetIndex","String","charAt","toUpperCase","slice","Modelize","hash_salt","sortable","hashed_index","has_data","ref6","ref7","param","isObservable","after_create"],"mappings":"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","sourcesContent":["var RESTConnector,\n  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nRESTConnector = (function() {\n  function RESTConnector(base, settings) {\n    var default_settings;\n    if (base == null) {\n      base = '/api/';\n    }\n    if (settings == null) {\n      settings = {};\n    }\n    this.init = bind(this.init, this);\n    this.get = bind(this.get, this);\n    default_settings = {\n      stripTrailingSlash: true,\n      methodOverride: true\n    };\n    settings = object_merge(settings, default_settings);\n    this.connector = new $.RestClient(base, settings);\n  }\n\n  RESTConnector.prototype.get = function(base_uri) {\n    return this.connector[base_uri];\n  };\n\n  RESTConnector.prototype.init = function(resource, sub_resources) {\n    var data, name, results;\n    if (sub_resources == null) {\n      sub_resources = [];\n    }\n    if (this.connector[resource] == null) {\n      this.connector.add(resource);\n    }\n    results = [];\n    for (name in sub_resources) {\n      data = sub_resources[name];\n      if (!this.connector[resource][name + 's']) {\n        results.push(this.connector[resource].add(name + 's'));\n      } else {\n        results.push(void 0);\n      }\n    }\n    return results;\n  };\n\n  return RESTConnector;\n\n})();\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Connector;\n}\n\n//# sourceMappingURL=connector.js.map\n","var Container;\n\nContainer = function(options) {\n  'use strict';\n  var container;\n  container = function(self) {\n    var fn, index, name, ref, ref1, ref2, ref3, ref4;\n    if (self == null) {\n      self = {};\n    }\n    Observable(self, '__updated');\n    self.editables = options.editable;\n    if ((options.selectable != null) && options.selectable === true) {\n      Selectable(self);\n    }\n    if (options.observable != null) {\n      ref = options.observable;\n      for (index in ref) {\n        name = ref[index];\n        Observable(self, name);\n      }\n    }\n    if (options.editable != null) {\n      ref1 = options.editable;\n      for (index in ref1) {\n        name = ref1[index];\n        Editable(self, name, (function(_this) {\n          return function() {\n            return self.__updated(self[\"export\"]());\n          };\n        })(this));\n      }\n    }\n    if (options.computed != null) {\n      ref2 = options.computed;\n      for (name in ref2) {\n        fn = ref2[name];\n        Computed(self, name, fn);\n      }\n    }\n    if (options.purecomputed != null) {\n      ref3 = options.purecomputed;\n      for (name in ref3) {\n        fn = ref3[name];\n        PureComputed(self, name, fn);\n      }\n    }\n    if (options.functions != null) {\n      ref4 = options.functions;\n      for (name in ref4) {\n        fn = ref4[name];\n        self[name] = fn;\n      }\n    }\n    self[\"export\"] = (function(_this) {\n      return function() {\n        var data, ref5;\n        data = {};\n        if (options.editable != null) {\n          ref5 = options.editable;\n          for (index in ref5) {\n            name = ref5[index];\n            data[name] = self[name]();\n          }\n        }\n        return data;\n      };\n    })(this);\n    return self;\n  };\n  return container;\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Container;\n}\n\n//# sourceMappingURL=container.js.map\n","var decryptData, encryptData, generateKey, generateSalt, getHash;\n\ngenerateKey = function(password, salt) {\n  var hex, options;\n  if (password === '') {\n    throw new Error('Password for key generation empty!');\n  }\n  hex = sjcl.codec.hex.fromBits;\n  if (salt == null) {\n    salt = generateSalt();\n  }\n  options = {\n    salt: salt,\n    iter: 5000\n  };\n  options = sjcl.misc.cachedPbkdf2(password, options);\n  return sjcl.codec.hex.fromBits(options.key);\n};\n\ngenerateSalt = function(length) {\n  var rand;\n  if (length == null) {\n    length = 2;\n  }\n  rand = sjcl.random.randomWords(length);\n  return sjcl.codec.hex.fromBits(rand);\n};\n\nencryptData = function(key, data, adata) {\n  var options, options_ret;\n  if (adata == null) {\n    adata = '';\n  }\n  if (key === '') {\n    throw new Error('Encryption key empty!');\n  }\n  options = {\n    mode: 'gcm',\n    iter: 5000,\n    ts: 64,\n    ks: 256,\n    adata: adata\n  };\n  options_ret = {};\n  return sjcl.encrypt(key, data, options, options_ret);\n};\n\ndecryptData = function(key, data) {\n  var options_ret;\n  if (key === '') {\n    throw new Error('Decryption key empty!');\n  }\n  options_ret = {};\n  return sjcl.decrypt(key, data, {}, options_ret);\n};\n\ngetHash = function(value) {\n  var hash;\n  if (value == null) {\n    console.debug('Hash value empty');\n    value = '';\n  }\n  hash = sjcl.hash.sha256.hash(value);\n  return sjcl.codec.hex.fromBits(hash);\n};\n\n//# sourceMappingURL=crypto.js.map\n","var CryptoHandler,\n  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nCryptoHandler = (function() {\n  function CryptoHandler(settings) {\n    this.save = bind(this.save, this);\n    this.load = bind(this.load, this);\n    if (settings.key == null) {\n      throw new Error('Please provide an encryption key to the crypto handler!');\n    }\n    this.key = settings.key;\n    if (settings.salt != null) {\n      this.salt = settings.salt;\n    }\n  }\n\n  CryptoHandler.prototype.load = function(data) {\n    var decrypted_data;\n    decrypted_data = decryptData(this.key, data);\n    return JSON.parse(decrypted_data);\n  };\n\n  CryptoHandler.prototype.save = function(data) {\n    return encryptData(this.key, ko.toJSON(data));\n  };\n\n  return CryptoHandler;\n\n})();\n\n//# sourceMappingURL=crypto.js.map\n","var HashHandler,\n  bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nHashHandler = (function() {\n  function HashHandler(settings) {\n    this.save = bind(this.save, this);\n    if (settings.salt == null) {\n      throw new Error('Please provide a salting hash to the hash handler!');\n    }\n    this.salt = settings.salt;\n  }\n\n  HashHandler.prototype.save = function(data) {\n    return getHash(data + this.salt);\n  };\n\n  return HashHandler;\n\n})();\n\n//# sourceMappingURL=hash.js.map\n","var JSONHandler;\n\nJSONHandler = (function() {\n  function JSONHandler() {}\n\n  JSONHandler.prototype.load = function(data) {\n    return JSON.parse(data);\n  };\n\n  JSONHandler.prototype.save = function(data) {\n    return JSON.stringify(data);\n  };\n\n  return JSONHandler;\n\n})();\n\n//# sourceMappingURL=json.js.map\n","var Ham;\n\nHam = function() {};\n\nHam.merge = function(a, b) {\n  var i, j, key, len, len1, ref, ref1, result;\n  result = {};\n  ref = Object.keys(a);\n  for (i = 0, len = ref.length; i < len; i++) {\n    key = ref[i];\n    result[key] = a[key];\n  }\n  ref1 = Object.keys(b);\n  for (j = 0, len1 = ref1.length; j < len1; j++) {\n    key = ref1[j];\n    if (a[key] == null) {\n      result[key] = b[key];\n    }\n  }\n  return result;\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Ham;\n}\n\n//# sourceMappingURL=ham.js.map\n","var create_fn, destroy_fn, get_fn, lazy_get_fn, lazy_single_get_fn, relationship_fields, single_get_fn, update_fn;\n\nrelationship_fields = function(name, model, connector, options) {\n  if (options == null) {\n    options = {};\n  }\n  return [name + '_id', name + 's', name, window[model], connector, options];\n};\n\nsingle_get_fn = function(id_param, api_name, name, model, api, options) {\n  if (options == null) {\n    options = {};\n  }\n  return (function(_this) {\n    return function(params, callbackOrObservable) {\n      var callback;\n      if (params == null) {\n        params = {};\n      }\n      if (typeof callback === \"undefined\" || callback === null) {\n        callback = function(data) {\n          return _this[name](model(data));\n        };\n      } else if (typeof callbackOrObservable['push'] === 'undefined') {\n        if (typeof callbackOrObservable !== 'function') {\n          throw new Error('model.find 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\\nGiven: ' + callbackOrObservable);\n        }\n        callback = callbackOrObservable;\n      }\n      return model.get_one(_this[id_param](), callback);\n    };\n  })(this);\n};\n\nlazy_get_fn = function(id_param, api_name, name, model, api, options) {\n  var callback;\n  if (typeof callback === \"undefined\" || callback === null) {\n    callback = (function(_this) {\n      return function(data) {\n        var i, len, m, res;\n        res = [];\n        for (i = 0, len = data.length; i < len; i++) {\n          m = data[i];\n          res.push(model(m));\n        }\n        return _this[api_name](res);\n      };\n    })(this);\n    return api[api_name].read(this.id).done(callback);\n  }\n};\n\nlazy_single_get_fn = function(id_param, api_name, name, model, api, options) {\n  var callback;\n  if (typeof this[id_param] !== 'function') {\n    throw new Error('External key not an observable: ' + id_param);\n  }\n  if (this[id_param]() == null) {\n    throw new Error('Tried to access empty relation key: ' + id_param);\n  }\n  if (typeof this[id_param]() === 'function') {\n    throw new Error('Circular referene? Quitting.');\n  }\n  if (typeof callback === \"undefined\" || callback === null) {\n    callback = (function(_this) {\n      return function(data) {};\n    })(this);\n    this[name](model(data));\n  }\n  return model.get_one(this[id_param](), callback);\n};\n\nget_fn = function(id_param, api_name, name, model, api, options) {\n  if (options == null) {\n    options = {};\n  }\n  return (function(_this) {\n    return function(params, callbackOrObservable) {\n      var callback;\n      if (params == null) {\n        params = {};\n      }\n      callback = function(data) {\n        var i, len, m, res;\n        res = [];\n        for (i = 0, len = data.length; i < len; i++) {\n          m = data[i];\n          res.push(model(m));\n        }\n        return _this[api_name](res);\n      };\n      if ((callbackOrObservable != null) && typeof callbackOrObservable['push'] === 'undefined') {\n        if (typeof callbackOrObservable !== 'function') {\n          throw new Error('model.find 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\\nGiven: ' + callbackOrObservable);\n        }\n        callback = callbackOrObservable;\n      }\n      if (api == null) {\n        throw new Error('No Connector found for resource \"' + api_name + '\" found: ', api);\n      }\n      if ((options.belongs_to != null) && options.belongs_to.length > 0) {\n        return api[api_name].read(options.belongs_to, _this.id, params).done(callback);\n      } else {\n        return api[api_name].read(_this.id, params).done(callback);\n      }\n    };\n  })(this);\n};\n\ncreate_fn = function(id_param, api_name, name, model, api, options) {\n  return (function(_this) {\n    return function(params, callback) {\n      if (params == null) {\n        params = {};\n      }\n      if (callback == null) {\n        callback = function(data) {\n          return _this[api_name].push(model(data));\n        };\n      }\n      if (_this.id == null) {\n        throw new Error('Empty ID. Save parent model first!');\n      }\n      if (model.encrypted_container != null) {\n        params = model.encrypt_container(params);\n      }\n      if (api == null) {\n        throw new Error('No Connector found for resource \"' + api_name + '\" found: ', api);\n      }\n      if (options.belongs_to.length > 0) {\n        return api[api_name].create(options.belongs_to, _this.id, params).done(callback);\n      } else {\n        return api[api_name].create(_this.id, params).done(callback);\n      }\n    };\n  })(this);\n};\n\nupdate_fn = function(id_param, api_name, name, model, api, options) {\n  return (function(_this) {\n    return function(id, params, callback) {\n      if (_this.id == null) {\n        throw new Error('Empty ID. Save parent model first!');\n      }\n      if (model.encrypted_container != null) {\n        params = model.encrypt_container(params);\n      }\n      if (options.belongs_to != null) {\n        api[api_name].update(options.belongs_to, _this.id, id, params).done(callback);\n      } else {\n        api[api_name].update(_this.id, id, params).done(callback);\n      }\n      if (_this.after_update != null) {\n        return _this.after_update();\n      }\n    };\n  })(this);\n};\n\ndestroy_fn = function(id_param, api_name, name, model, api, options) {\n  return (function(_this) {\n    return function(id, callback) {\n      if (callback == null) {\n        callback = function(data) {\n          return _this[api_name].remove(element);\n        };\n      }\n      if (_this.id == null) {\n        throw new Error('Empty ID. Save parent model first!');\n      }\n      api = connector.get(api_name);\n      if (options.belongs_to != null) {\n        return api[api_name].destroy(options.belongs_to, _this.id, id).done(callback);\n      } else {\n        return api[api_name].destroy(_this.id, id).done(callback);\n      }\n    };\n  })(this);\n};\n\n//# sourceMappingURL=helpers.js.map\n","var Containable;\n\nContainable = function(self, options) {\n  var container_fn, datahandler, field, first_class, name, ref, settings;\n  self.init_single_container = (function(_this) {\n    return function(name, datahandler, container_fn, field, first_class, options) {\n      var data, editable, i, len, ref;\n      data = null;\n      if (self[field] != null) {\n        data = datahandler.load(self[field]);\n      }\n      Observable(self, name, new container_fn(data));\n      ref = self[name]().editables;\n      for (i = 0, len = ref.length; i < len; i++) {\n        editable = ref[i];\n        MappedObservable(self, editable, self[name]());\n      }\n      return self[name]().__updated.subscribe(function(data) {\n        var callback;\n        callback = DelayedSave.apply(self, [options, self, datahandler]);\n        return callback(data, field);\n      });\n    };\n  })(this);\n  self.init_multi_container = (function(_this) {\n    return function(name, datahandler, container_fn, field, options) {\n      var c, data, i, item, items, len;\n      data = null;\n      if (self[field] != null) {\n        data = datahandler.load(self[field]);\n      }\n      items = [];\n      if (data != null) {\n        for (i = 0, len = data.length; i < len; i++) {\n          item = data[i];\n          c = new container_fn(item);\n          items.push(c);\n          c.__updated.subscribe(function() {\n            var callback;\n            callback = DelayedSave.apply(self, [options, self, datahandler]);\n            return callback(self[name](), field);\n          });\n        }\n      }\n      ObservableArray(self, name, items);\n      self[name + '_add'] = function(params) {\n        if (params == null) {\n          params = {};\n        }\n        c = container_fn(params);\n        self[name].push(c);\n        return c.__updated.subscribe(function() {\n          var callback;\n          callback = DelayedSave.apply(self, [options, self, datahandler]);\n          return callback(self[name](), field);\n        });\n      };\n      return self[name].subscribe(function() {\n        var callback;\n        callback = DelayedSave.apply(self, [options, self, datahandler]);\n        return callback(self[name](), field);\n      });\n    };\n  })(this);\n  ref = options.container;\n  for (name in ref) {\n    settings = ref[name];\n    container_fn = window[name];\n    if (settings.container != null) {\n      container_fn = window[settings.container];\n    }\n    if (typeof container_fn !== 'function') {\n      throw new Error('No container \"' + name + '\" found.');\n    }\n    field = name.toLowerCase();\n    if (settings.field != null) {\n      field = settings.field;\n    }\n    if (settings.datahandler != null) {\n      datahandler = settings.datahandler;\n    }\n    if (settings.datahandler == null) {\n      datahandler = new JSONHandler();\n    }\n    first_class = false;\n    if (settings.first_class != null) {\n      first_class = settings.first_class;\n    }\n    if ((settings.type != null) && settings.type === 'multi') {\n      self.init_multi_container(name, datahandler, container_fn, field, options);\n    } else {\n      self.init_single_container(name, datahandler, container_fn, field, first_class, options);\n    }\n  }\n  return self;\n};\n\n//# sourceMappingURL=containable.js.map\n","var DelayedSave, Editable, EncryptedDelayedSave, HashedSave;\n\nEditable = function(self, property, callback) {\n  var editing_property;\n  editing_property = 'editing_' + property;\n  Observable(self, property);\n  Observable(self, editing_property, 'default');\n  self[property].subscribe((function(_this) {\n    return function(new_value) {\n      var r;\n      return r = callback(new_value, property);\n    };\n  })(this));\n  return self;\n};\n\nDelayedSave = function(options, self, datahandler) {\n  if (datahandler == null) {\n    datahandler = null;\n  }\n  return (function(_this) {\n    return function(value, prop, delay) {\n      if (delay == null) {\n        delay = 250;\n      }\n      if (self.id != null) {\n        if (self['editing_' + prop] != null) {\n          self['editing_' + prop]('pending');\n        }\n        if (window.timeoutEditor == null) {\n          window.timeoutEditor = {};\n        }\n        if (window.timeoutEditor[options.api + self.id] == null) {\n          window.timeoutEditor[options.api + self.id] = {};\n        }\n        clearTimeout(window.timeoutEditor[options.api + self.id][prop]);\n        return window.timeoutEditor[options.api + self.id][prop] = setTimeout(function() {\n          var edit_value;\n          if (self['editing_' + prop] != null) {\n            self['editing_' + prop]('success');\n          }\n          edit_value = {};\n          edit_value[prop] = value;\n          if (datahandler != null) {\n            edit_value[prop] = datahandler.save(value);\n          }\n          return self.update(edit_value);\n        }, delay);\n      }\n    };\n  })(this);\n};\n\nHashedSave = function(options, self) {\n  return (function(_this) {\n    return function(value, prop) {\n      var edit_value;\n      if (self.id != null) {\n        if (self['editing_' + prop] != null) {\n          self['editing_' + prop]('pending');\n        }\n        if (self.encryption_salt != null) {\n          value += self.encryption_salt;\n        } else {\n          console.log('No salt for hash found. Intentional?');\n        }\n        edit_value = {};\n        edit_value[prop] = getHash(value);\n        return self.update(edit_value);\n      }\n    };\n  })(this);\n};\n\nEncryptedDelayedSave = function(options, self) {\n  return (function(_this) {\n    return function(value, prop, delay) {\n      var index, name, ref;\n      if (delay == null) {\n        delay = 250;\n      }\n      if (typeof self[options.encrypted_container] !== 'object' || self[options.encrypted_container] === null) {\n        self[options.encrypted_container] = {};\n        ref = options.encrypted_editable;\n        for (index in ref) {\n          name = ref[index];\n          self[options.encrypted_container][name] = self[name]();\n        }\n      }\n      self[options.encrypted_container][prop] = value;\n      if (self.id != null) {\n        self['editing_' + prop]('pending');\n        if (window.timeoutEditor == null) {\n          window.timeoutEditor = {};\n        }\n        clearTimeout(window.timeoutEditor[options.api + self.id]);\n        return window.timeoutEditor[options.api + self.id] = setTimeout(function() {\n          var edit_value;\n          self.save_encrypted_container();\n          if (self['editing_' + prop] != null) {\n            self['editing_' + prop]('success');\n          }\n          if (options.encrypted_debug === true) {\n            edit_value = {};\n            edit_value[prop] = value;\n            return self.update(edit_value);\n          }\n        }, delay);\n      }\n    };\n  })(this);\n};\n\n//# sourceMappingURL=editable.js.map\n","var Encryptable,\n  indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nEncryptable = function(self, encrypted_container, encrypted_editable) {\n  var container, i, len;\n  self.decrypt = (function(_this) {\n    return function(encrypted_container) {\n      var dencdata, index, results, value;\n      if (self.encryption_key == null) {\n        throw new Error('No encryption key found! Pass it in the options hash as encryption.key');\n      }\n      if (typeof encrypted_container === 'string' && encrypted_container !== null && encrypted_container !== '') {\n        dencdata = decryptData(self.encryption_key, encrypted_container);\n        encrypted_container = JSON.parse(dencdata);\n        results = [];\n        for (index in encrypted_container) {\n          value = encrypted_container[index];\n          results.push(self[index] = value);\n        }\n        return results;\n      }\n    };\n  })(this);\n  if (typeof encrypted_container === 'string') {\n    self.decrypt(self[encrypted_container]);\n  } else if (typeof encrypted_container === 'object') {\n    for (i = 0, len = encrypted_container.length; i < len; i++) {\n      container = encrypted_container[i];\n      self.decrypt(self[container]);\n    }\n  }\n  self.encrypted_update = (function(_this) {\n    return function(data, callback) {\n      var index, value;\n      for (index in data) {\n        value = data[index];\n        if (indexOf.call(encrypted_editable, index) >= 0) {\n          if (typeof self[encrypted_container] !== 'object' || self[encrypted_container] === null) {\n            self[encrypted_container] = {};\n          }\n          self[encrypted_container][index] = value;\n        }\n      }\n      self.save_encrypted_container();\n      if (callback != null) {\n        return callback();\n      }\n    };\n  })(this);\n  self.save_encrypted_container = (function(_this) {\n    return function() {\n      var edit_value, encdata;\n      if (self.encryption_key == null) {\n        throw new Error('No encryption key found! Pass it in the options hash as encryption.key');\n      }\n      encdata = encryptData(self.encryption_key, JSON.stringify(self[encrypted_container]));\n      edit_value = {};\n      edit_value[encrypted_container] = encdata;\n      return self.update(edit_value);\n    };\n  })(this);\n  return self;\n};\n\n//# sourceMappingURL=encryptable.js.map\n","var Computed, LazyObservable, LazyObservableArray, MappedObservable, Observable, ObservableArray, PureComputed;\n\nObservable = function(self, property, initial_value) {\n  if (initial_value === void 0) {\n    initial_value = self[property];\n  }\n  return self[property] = ko.observable(initial_value);\n};\n\nObservableArray = function(self, property, initial_value) {\n  if (initial_value === void 0) {\n    initial_value = [];\n  }\n  self[property] = ko.observableArray(initial_value);\n  self[property].select = function(fn) {\n    return ko.utils.arrayFilter(self[property].call(), fn);\n  };\n  return self[property].map = function(fn) {\n    return ko.utils.arrayMap(self[property].call(), fn);\n  };\n};\n\nComputed = function(self, property, fn) {\n  return self[property] = ko.computed(fn, self);\n};\n\nPureComputed = function(self, property, fn) {\n  return self[property] = ko.pureComputed(fn, self);\n};\n\nMappedObservable = function(self, property, container) {\n  return self[property] = ko.computed({\n    read: function() {\n      return container[property]();\n    },\n    write: function(value) {\n      return container[property](value);\n    }\n  });\n};\n\nLazyObservable = function(self, property, callback, params, init_value, make_array) {\n  var _value;\n  if (params == null) {\n    params = [];\n  }\n  if (init_value == null) {\n    init_value = null;\n  }\n  if (make_array == null) {\n    make_array = false;\n  }\n  if (!make_array) {\n    _value = ko.observable(init_value);\n  } else {\n    _value = ko.observableArray(init_value);\n  }\n  self[property] = ko.computed({\n    read: function() {\n      if (self[property].loaded() === false) {\n        callback.apply(self, params);\n      }\n      return _value();\n    },\n    write: function(newValue) {\n      self[property].loaded(true);\n      return _value(newValue);\n    },\n    deferEvaluation: true\n  });\n  if (make_array === true) {\n    self[property].remove = function(e) {\n      return _value.remove(e);\n    };\n    self[property].push = function(e) {\n      return _value.push(e);\n    };\n    self[property].splice = function(e, i, args) {\n      return _value.splice(e, i, args);\n    };\n  }\n  self[property].loaded = ko.observable(false);\n  return self[property].refresh = function() {\n    return self[property].loaded(false);\n  };\n};\n\nLazyObservableArray = function(self, property, callback, params, init_value) {\n  if (params == null) {\n    params = [];\n  }\n  if (init_value == null) {\n    init_value = null;\n  }\n  return LazyObservable(self, property, callback, params, init_value, true);\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = {\n    Observable: Observable,\n    ObservableArray: ObservableArray,\n    Computed: Computed,\n    ComputedArray: ComputedArray,\n    LazyObservable: LazyObservable\n  };\n}\n\n//# sourceMappingURL=observable.js.map\n","var Computed, Observable, Observables, Paginated;\n\nif (typeof require !== \"undefined\" && require !== null) {\n  Observables = require('../lib/observable');\n  Observable = Observables.Observable;\n  Computed = Observables.Computed;\n}\n\nPaginated = function(self, options) {\n  if (!((self != null) && (options != null))) {\n    throw new Error('Error: no object or options given');\n  }\n  if ('object' !== typeof self) {\n    throw new Error('Error: first parameter is not an object');\n  }\n  if ('function' === typeof options) {\n    options = {\n      method: options\n    };\n  }\n  if ('object' !== typeof options) {\n    throw new Error('Invalid type for second parameter (' + typeof options + '), expected function or object');\n  }\n  options = object_merge(options, {\n    per_page: 20,\n    page: 0\n  });\n  if (options.page > 0) {\n    options.page--;\n  }\n  if (!(typeof options.per_page === 'number' && options.per_page > 0)) {\n    throw new Error('Invalid per_page value given');\n  }\n  if (options.method == null) {\n    throw new Error('No reload method given');\n  }\n  return Paginated.add_paginated_methods(self, options);\n};\n\nPaginated.add_paginated_methods = function(self, options) {\n  Observable(self, '__collection', options.collection);\n  Observable(self, '__reload', options.method);\n  Observable(self, '__page', options.page);\n  Observable(self, 'per_page', options.per_page);\n  Computed(self, 'page', (function(_this) {\n    return function() {\n      return self.__page() + 1;\n    };\n  })(this));\n  Computed(self, 'count', (function(_this) {\n    return function() {\n      if (self.__collection() != null) {\n        return self.__collection().count;\n      }\n      return 0;\n    };\n  })(this));\n  Computed(self, 'pages', (function(_this) {\n    return function() {\n      var result;\n      result = parseInt(parseFloat(self.count()) / parseFloat(self.__page()));\n      if (parseFloat(self.count()) % self.__page() > 0) {\n        result++;\n      }\n      return result;\n    };\n  })(this));\n  self.first_page = (function(_this) {\n    return function() {\n      self.__page(0);\n      return self.__collection(self.__reload());\n    };\n  })(this);\n  self.last_page = (function(_this) {\n    return function() {\n      self.__page(self.count() - 1);\n      return self.__collection(self.__reload());\n    };\n  })(this);\n  self.previous_page = (function(_this) {\n    return function() {\n      if (!(self.page() > 0)) {\n        return;\n      }\n      self.__page(self.page() - 1);\n      return self.__collection(self.__reload());\n    };\n  })(this);\n  return self.next_page = (function(_this) {\n    return function() {\n      if (!(self.page() + 1 < self.pages())) {\n        return;\n      }\n      self.__page(self.page() + 1);\n      return self.__collection(self.__reload());\n    };\n  })(this);\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Paginated;\n}\n\n//# sourceMappingURL=paginated.js.map\n","var Relatable,\n  indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nRelatable = function(self, options) {\n  var data, fn, i, item, items, len, name, ref, ref1, ref2, ref3, relation_params, results;\n  if (options.belongs_to != null) {\n    if (options.has_one == null) {\n      options.has_one = [];\n    }\n    options.has_one = object_merge(options.belongs_to, options.has_one);\n  } else {\n    options.belongs_to = [];\n  }\n  if (options.has_one != null) {\n    ref = options.has_one;\n    for (name in ref) {\n      data = ref[name];\n      object_merge(data, {\n        model: name.capitalize()\n      });\n      relation_params = relationship_fields(name, data.model, self.api(), options);\n      fn = window[data.model];\n      if (typeof fn !== 'function') {\n        throw new Error('No model for has_one/belongs_to relation found');\n      }\n      if (typeof self[name + '_id'] !== 'function' && indexOf.call(options.belongs_to, name) < 0) {\n        if (options.editable == null) {\n          options.editable = [];\n        }\n        if (ref1 = name + '_id', indexOf.call(options.editable, ref1) < 0) {\n          options.editable.push(name + '_id');\n        }\n      }\n      if (self[name] != null) {\n        Observable(self, name, new fn(self[name]));\n      } else {\n        Observable(self, name, new fn());\n      }\n      self[name + '_get'] = single_get_fn.apply(self, relation_params);\n    }\n  }\n  if (options.has_many != null) {\n    ref2 = options.has_many;\n    results = [];\n    for (name in ref2) {\n      data = ref2[name];\n      object_merge(data, {\n        model: name.capitalize()\n      });\n      relation_params = relationship_fields(name, data.model, self.api(), options);\n      if (self[name + 's'] != null) {\n        fn = window[data.model];\n        items = [];\n        ref3 = self[name + 's'];\n        for (i = 0, len = ref3.length; i < len; i++) {\n          item = ref3[i];\n          items.push(new fn(item));\n        }\n        ObservableArray(self, name + 's', items);\n      } else {\n        ObservableArray(self, name + 's', []);\n      }\n      self[name + '_get'] = get_fn.apply(self, relation_params);\n      self[name + '_add'] = create_fn.apply(self, relation_params);\n      self[name + '_update'] = update_fn.apply(self, relation_params);\n      results.push(self[name + '_destroy'] = destroy_fn.apply(self, relation_params));\n    }\n    return results;\n  }\n};\n\n//# sourceMappingURL=relatable.js.map\n","var Selectable;\n\nSelectable = function(self) {\n  self.selected = ko.observable(false);\n  self.select = (function(_this) {\n    return function(item, element) {\n      return self.selected(!self.selected());\n    };\n  })(this);\n  return self;\n};\n\n//# sourceMappingURL=selectable.js.map\n","var Sortable;\n\nSortable = function(self) {\n  self.move = (function(_this) {\n    return function(to, callback) {\n      return self.update({\n        sort: to\n      }, callback);\n    };\n  })(this);\n  self.move_ui = (function(_this) {\n    return function(element) {\n      var item, to;\n      item = element.item;\n      to = element.targetIndex;\n      return item.update({\n        sort: to\n      });\n    };\n  })(this);\n  return self;\n};\n\n//# sourceMappingURL=sortable.js.map\n","var object_merge;\n\nString.prototype.capitalize = function() {\n  return this.charAt(0).toUpperCase() + this.slice(1);\n};\n\nobject_merge = function(a, b) {\n  var i, j, key, len, len1, ref, ref1, result;\n  result = {};\n  ref = Object.keys(a);\n  for (i = 0, len = ref.length; i < len; i++) {\n    key = ref[i];\n    result[key] = a[key];\n  }\n  ref1 = Object.keys(b);\n  for (j = 0, len1 = ref1.length; j < len1; j++) {\n    key = ref1[j];\n    if (a[key] == null) {\n      result[key] = b[key];\n    }\n  }\n  return result;\n};\n\n//# sourceMappingURL=utils.js.map\n","var Modelize,\n  indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n\nModelize = function(options) {\n  'use strict';\n  var connector, model, sub_resources;\n  if (options.connector == null) {\n    throw new Error('No connector given for API URI: ' + options.api);\n  }\n  sub_resources = [];\n  if (options.has_one != null) {\n    sub_resources = object_merge(sub_resources, options.has_one);\n  }\n  if (options.has_many != null) {\n    sub_resources = object_merge(sub_resources, options.has_many);\n  }\n  options.connector.init(options.api, sub_resources);\n  connector = options.connector.get(options.api);\n  model = function(self) {\n    var fn, index, name, ref, ref1, ref2, ref3, ref4, ref5;\n    if (self == null) {\n      self = {};\n    }\n    self.api = function() {\n      return connector;\n    };\n    if (options.hash_salt != null) {\n      self.hash_salt = options.hash_salt;\n    }\n    if ((options.sortable != null) && options.sortable === true) {\n      Sortable(self);\n    }\n    if ((options.selectable != null) && options.selectable === true) {\n      Selectable(self);\n    }\n    if ((options.has_one != null) || (options.has_many != null) || (options.belongs_to != null)) {\n      Relatable(self, options);\n    }\n    if (options.container != null) {\n      Containable(self, options);\n    }\n    if (options.observable != null) {\n      ref = options.observable;\n      for (index in ref) {\n        name = ref[index];\n        Observable(self, name);\n      }\n    }\n    if (options.editable != null) {\n      ref1 = options.editable;\n      for (index in ref1) {\n        name = ref1[index];\n        Editable(self, name, DelayedSave.apply(self, [options, self]));\n      }\n    }\n    if (options.hashed_index != null) {\n      ref2 = options.hashed_index;\n      for (index in ref2) {\n        name = ref2[index];\n        Editable(self, name, HashedSave.apply(self, [options, self]));\n      }\n    }\n    if (options.computed != null) {\n      ref3 = options.computed;\n      for (name in ref3) {\n        fn = ref3[name];\n        Computed(self, name, fn);\n      }\n    }\n    if (options.purecomputed != null) {\n      ref4 = options.purecomputed;\n      for (name in ref4) {\n        fn = ref4[name];\n        PureComputed(self, name, fn);\n      }\n    }\n    if (options.functions != null) {\n      ref5 = options.functions;\n      for (name in ref5) {\n        fn = ref5[name];\n        self[name] = fn;\n      }\n    }\n    self.update = (function(_this) {\n      return function(params, callback) {\n        if (self.id == null) {\n          throw new Error('Trying to update nonexisting model object');\n        }\n        return self.api().update(self.id, params).done(callback);\n      };\n    })(this);\n    self.destroy = (function(_this) {\n      return function(callback) {\n        if (self.id == null) {\n          throw new Error('Trying to delete nonexisting model object');\n        }\n        return self.api().destroy(self.id).done(callback);\n      };\n    })(this);\n    self.create = (function(_this) {\n      return function(callback) {\n        return self.api().create(self[\"export\"]()).done(function(data) {\n          self.id = data.id;\n          return callback();\n        });\n      };\n    })(this);\n    self[\"export\"] = (function(_this) {\n      return function(id) {\n        var data, has_data, ref6, ref7;\n        if (id == null) {\n          id = false;\n        }\n        data = {};\n        if (id === true) {\n          data['id'] = self['id'];\n        }\n        if (options.editable != null) {\n          ref6 = options.editable;\n          for (index in ref6) {\n            name = ref6[index];\n            data[name] = self[name]();\n          }\n        }\n        if (options.belongs_to != null) {\n          ref7 = options.belongs_to;\n          for (name in ref7) {\n            has_data = ref7[name];\n            data[name + '_id'] = self[name + '_id']();\n          }\n        }\n        return data;\n      };\n    })(this);\n    return self;\n  };\n\n  /*\n   * These are the collection functions and are not bound to a specific object but to the model\n   */\n  model.get = function(params, callbackOrObservable) {\n    var callback, param, salt;\n    if (params == null) {\n      params = {};\n    }\n    callback = function(data) {\n      var i, len, m, results;\n      results = [];\n      for (i = 0, len = data.length; i < len; i++) {\n        m = data[i];\n        results.push(callbackOrObservable.push(model(m)));\n      }\n      return results;\n    };\n    if (typeof callbackOrObservable['push'] === 'undefined') {\n      if (typeof callbackOrObservable !== 'function') {\n        throw new Error('Collection.get 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\\nGiven: ' + callbackOrObservable);\n      }\n      callback = callbackOrObservable;\n    }\n    if (typeof params !== 'object') {\n      throw new Error('Passed params is not an object: ' + typeof params);\n    }\n    if ((options.hashed_index != null) && (params != null)) {\n      salt = '';\n      if (options.hash_salt != null) {\n        salt = options.hash_salt;\n      }\n      for (param in params) {\n        if (indexOf.call(options.hashed_index, param) >= 0) {\n          params[param] = getHash(params[param] + salt);\n        }\n      }\n    }\n    if ((params != null) && (params.id != null)) {\n      connector.read(params.id, params).done(callback);\n    } else {\n      connector.read(params).done(callback);\n    }\n  };\n  model.get_one = function(id, callbackOrObservable) {\n    var callback;\n    callback = function(data) {\n      return callbackOrObservable(model(data));\n    };\n    if (ko.isObservable(callbackOrObservable) === false) {\n      if (typeof callbackOrObservable !== 'function') {\n        throw new Error('Collection.get_one 2nd parameter needs to be either a function or an Observable.\\nGiven: ' + callbackOrObservable);\n      }\n      callback = callbackOrObservable;\n    }\n    return model.get({\n      id: id\n    }, callbackOrObservable);\n  };\n  model.create = function(params, callbackOrObservable) {\n    var callback;\n    if (params == null) {\n      params = {};\n    }\n    callback = function(data) {\n      return callbackOrObservable.push(model(data));\n    };\n    if (typeof callbackOrObservable['push'] === 'undefined') {\n      if (typeof callbackOrObservable !== 'function') {\n        throw new Error('Collection.create 2nd parameter needs to be either a function or a pushable object (Array, ObservableArray).\\nGiven: ' + callbackOrObservable);\n      }\n      callback = (function(_this) {\n        return function(data) {\n          var m;\n          m = model(JSON.parse(JSON.stringify(data)));\n          if (m.after_create != null) {\n            m.after_create();\n          }\n          return callbackOrObservable(data);\n        };\n      })(this);\n    }\n    if (params.length > 0 || typeof params === 'object') {\n      connector.create(params).done(callback);\n    } else {\n      connector.create().done(callback);\n    }\n  };\n  return model;\n};\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = Modelize;\n}\n\n//# sourceMappingURL=model.js.map\n"]}